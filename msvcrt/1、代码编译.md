
### 一、问题列表

1、从源码开始编译msvcrt，对于理解visual studio有很大的帮助。但是基于vs2008提供的源码是无法直接编译成库，主要是缺乏__forceManifestXXX相关的定义，网络上也少有相关资料。

2、msvcrt有静态库、调试版静态库、动态库、调试版动态库4种编译选项，单线程类已经废弃，可以不理。每个选项包含文件还不一致。

3、src目录混合了预编译库、ASM、C、C++、CLR代码，这些代码有一定的相关度，特别是C/C++之间，耦合性颇高，剥离难度较大。

4、预编译库部分没有提供源码，就是有提供的源码，也没有对应编译规则。

### 二、解决方案

1、拷贝源码到独立目录中，配置编译环境。

2、执行nmake，主要解决manifest的问题。形成一个初始版本，可以编译通过。

3、从makefile中，删除和CLR相关的编译命令，直到最终编译成功，但没有生成对应的库。

4、删除没有被引用到的预编译文件和源文件，继续编译，直到成功。最终只剩下C/C++相关的源文件。

5、编译ASM失败，生成预编译库失败，暂时放弃。

6、剥离C++部分失败，无法解决locale相关的问题，需要继续投入时间，暂时不管了。


三、精简启动

1、目标是剥离所有的函数实现，只留下启动部分。这样做的目的，可以为未来移植posix的实现，替换原生的运行库提供基础。

2、整理visual studio在不同的运行场景中，实现的初始化启动代码。

